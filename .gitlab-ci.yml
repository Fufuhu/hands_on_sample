image: docker:latest
services:
   - docker:dind

before_script:
  - docker login -u gitlab-ci-token -p $CI_JOB_TOKEN registry.gitlab.com

build:
   stage: build
   script:
     - docker build -t registry.gitlab.com/fufuhu/hands_on_sample/guestbook:latest .
     - docker push registry.gitlab.com/fufuhu/hands_on_sample:latest
   tags:
     - docker